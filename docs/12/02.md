---
lang: zh-CN
title: Section 12.2 Network Interface Configuration
description: some description
---

As you study this section, answer the following questions:

<ul><li>What is the advantage of using dynamic addressing rather than static addressing?</li>
<li>Where is the interface configuration file located on the system?</li>
<li>How can you view the current status of the network interfaces from the shell prompt?</li>
<li>Which utilities can disable and enable the network interfaces?</li></ul>

In this lesson, you will learn to:

<ul><li>Use ping and traceroute</li>
<li>Start a NIC</li>
<li>Stop a NIC</li>
<li>Configure IP addresses</li></ul>

Key terms for this section include the following:

<table class="terms">
   <thead><tr><th class_="firstTableHeader" scope="col" class="fw-bold">
     Term</th>
    <th scope="col" class="fw-bold">
     Definition</th></tr></thead>
   <tbody><tr><td>Network interface alias</td>
<td>A designation, such as eth0 or en0, that is
associated with network interface cards.</td></tr>
<tr><td>Interface configuration file</td>
<td>A file in the /etc/sysconfig/network directory
that is used to configure a network interface.</td></tr>
<tr><td>Static IP assignment</td>
<td>Manually assigning an IP address to a host.</td></tr>
<tr><td>DHCP IP assignment</td>
<td>Dynamically assigning an IP address to a host
through a DHCP server.</td></tr>
<tr><td>Bonding</td>
<td>A method for aggregating multiple NICs into a
single logical (bonded) interface.</td></tr></tbody></table>

This section helps you prepare for the following certification exam objectives:

<table class="objectives">
<thead>
  <tr>
    <th>Exam</th>
    <th>Objective</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td>TestOut Linux Pro</td>
    <td>
      3.1 Configure networking
      <ul>
        <li>Find the IP address or DNS of a host</li>
        <li>Enable or disable network interfaces</li>
        <li>Configure IP addresses</li>
        <li>Troubleshoot IP configuration</li>
      </ul>
    </td>
  </tr>
  <tr>
    <td>CompTIA Linux+ XK0-005</td>
    <td>
      1.4 Given a scenario, configure and use the appropriate processes
      and services
      <ul>
        <li>
          System services
          <ul>
            <li>
              systemctl
              <ul>
                <li>stop</li>
                <li>start</li>
                <li>restart</li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
      <p>
        1.5 Given a scenario, use the appropriate networking tools or
        configuration files
      </p>
      <ul>
        <li>
          Interface management
          <ul>
            <li>
              iproute2 tools
              <ul>
                <li>ip</li>
              </ul>
            </li>
            <li>
              net-tools
              <ul>
                <li>ifconfig</li>
                <li>ifcfg</li>
                <li>hostname</li>
                <li>route</li>
              </ul>
            </li>
            <li>/etc/sysconfig/network-scripts/</li>
          </ul>
        </li>
        <li>
          Name resolution
          <ul>
            <li>/etc/resolv.conf</li>
          </ul>
        </li>
        <li>
          Network monitoring
          <ul>
            <li>traceroute</li>
            <li>ping</li>
          </ul>
        </li>
      </ul>
      <p>1.7 Given a scenario, manage software configurations</p>
      <ul>
        <li>
          Configure kernel options
          <ul>
            <li>insmod</li>
            <li>modprobe</li>
          </ul>
        </li>
      </ul>
      <p>3.1 Configure networking</p>
      <ul>
        <li>Enable or disable network interfaces</li>
        <li>Troubleshoot an IP configuration</li>
      </ul>
    </td>
  </tr>
</tbody>
</table>

## 12.2.1 Network Interface Naming

Click one of the buttons to take you to that part of the video.

Network Interface Naming 00:00-00:23
The first thing you need to do when configuring a Linux system to connect to an Ethernet network is install a network interface card, or a NIC. Most modern systems include an integrated Ethernet interface that's built into the motherboard itself. If this is the case, you're already good to go. All you have to do is plug it into the network.

Network Interface Module Installation 00:23-01:24
If your system doesn't include an integrated network interface and you have one that will work with your current hardware, the first thing you need to do is power the system off. Then you need to install an Ethernet board in an available expansion slot. Next, connect the Ethernet board to your network switch or hub with the appropriate drop cable. And finally, power the system back on.

If you installed a modern Ethernet board, then your Linux operating system should detect it as it boots up and automatically load whatever kernel modules are required. If you've purchased and installed an off-brand Ethernet network interface or a very old Ethernet interface, you may have to go to the card vendor's website, download the appropriate module, and load it manually. But most of the time, that isn't necessary.

After the system is booted, you need to check your module configuration file and verify that the appropriate kernel module was loaded for your network interface and that an alias has been created for the new network board.

Network Interface Module Configuration 01:24-02:03
The file that you need to check depends upon which distribution you're using. Some distributions use the /etc/modprobe.conf file or the /etc/modules.conf file.

Some others use a configuration file located in the /etc/modprobe.d directory. That's the case in this example. Within my /etc/modprobe.d directory, there's a file called 50-vmnics.conf. This configuration file specifies which kernel modules need to be loaded to support this network board.

Network Device Aliases Under init 02:03-02:22
The alias that gets assigned to your network interface will also depend upon your distribution. Older distributions that are based on the init daemon will assign eth0 to the first Ethernet adapter in your system. It'll assign eth1 to the second one, eth2 to the third, and so on.

Predictable Network Interface Names 02:22-05:21
Newer distributions that are based on systemd instead of init no longer use these aliases. Systemd uses predictable network interface names. One of the benefits of doing this is that specific aliases are permanently assigned to specific network interface cards, ensuring the same adapter always gets the same alias. The aliases are defined and assigned based on several different parameters in the order shown here.

If we're dealing with an onboard network adapter that's built into the motherboard itself, then an index number is provided by the system firmware, either UEFI or the BIOS, and it's used to construct the alias.

An example is shown here. First, en indicates that it's an Ethernet interface, and the o and the 1 indicate the onboard device index number (in this case, it's just device number 1). That means the network interface integrated into the motherboard would always be assigned the alias of eno1.

If the network adapter is plugged into a PCI slot instead of being integrated into the motherboard, then systemd will use the index number of the slot itself, and this is again provided by the UEFI firmware or the BIOS on the system, and it will use this information to construct the alias.

An example of that is shown here. We have en to indicate that this is an Ethernet interface, and then s1 indicates the hot plug slot index number. This is where the network interface card has been inserted into the motherboard.

What if the first two options are not applicable? What if, for example, we've connected a network interface into a USB connector instead of into a slot or integrating it into the motherboard? Then systemd tries to construct an alias for the network interface using the name of the physical connector that the interface is connected to.

Here's an example. We use en to indicate that it's an Ethernet interface, and then p2 identifies the bus that the interface is connected to. In this case, we're looking at USB bus 2, and the s0 indicates the slot number on the bus that the device is connected to, so it's connected to Slot 0.

There may be a situation when the first three options aren't applicable, and they fail. When this happens, systemd will try to use the interface card's MAC address to construct an alias.

As you can see here, because we're using the MAC address, the alias name gets really long. We use en to identify that it's an Ethernet interface, then an x to indicate that we're using a MAC address. And finally, we put in the MAC address that's assigned by the card.

Because this alias is a little bit funky, long, and difficult to work with, this rule is sometimes disabled by default. If none of these first four rules work, systemd will default back to the old init naming standard and just call the interface eth0.

Non-Ethernet Device Names 05:21-06:18
In the preceding examples, every single interface we looked at started with en because they're Ethernet interfaces. They're connected to an Ethernet switch, and they participate on an Ethernet network. However, this is not the only kind of interface you can install in the Linux system.

If you install a different type of interface in the system and connect it to a different type of network, a different prefix is used for the alias name.

For example, if we install a serial line interface in the Linux system and use it for, say, a WAN connection, then the name of that serial line interface is going to begin with sl instead of en to indicate that it's a serial interface, not an Ethernet interface.

Likewise, a lot of Linux systems use wireless interfaces. If you install a wireless network interface in the system, the alias for those interfaces will begin with wl instead of en.

Summary 06:18-06:42
That's it for this lesson. In this video, we reviewed how Linux creates aliases for network interfaces. First, we reviewed how the older init daemon created network device aliases. Then we reviewed how systemd uses predictable network interface names to create network device aliases.

## 12.2.2 Address Configuration Part 1

Click one of the buttons to take you to that part of the video.

Address Configuration 00:00-00:27
After installing a network interface in your Linux system, you need to configure four different parameters on that interface for that system to participate on an IP-based computer network. Those parameters are IP address, subnet mask, defining the default gateway router address, and assigning the DNS server address.

In this lesson, we'll focus on the first two parameters—assigning the IP address and the subnet mask.

Address Assignment Options 00:27-02:03
There are two ways to accomplish this. The first is a static IP address assignment, and the second is a dynamic IP address assignment.

In a static IP address assignment, you manually configure the network host with an IP address and subnet mask. If you do this, the IP address stays static. It never changes. This is the preferred option for working with a network server because you don't want server IP addresses changing.

However, we typically don't use static IP address assignment for workstations. This is because if you use a static IP address assignment, that host will consume that IP address, whether the system is in use or not. It also requires a lot of legwork from the system administrator because you must visit every single computer and manually specify the IP networking parameters.

The opposite is true for dynamic IP address assignment. With this one, the computer goes out on the network and contacts a dynamic host configuration protocol server, or DHCP Server, when that system first boots up. The DHCP server automatically assigns whatever IP address is currently available to that host for a specific amount of time. That's called lease time.

This option makes it easy to configure IP networking parameters on a very large number of network hosts without having to do much. Just turn the workstation on, and it gets its IP addressing information. It also conserves IP address usage because addresses being used by systems that are powered off can be reassigned to another network host that currently needs it.

The reason this won't typically be used for servers is because the address that gets assigned to a particular host can change frequently. This isn't a good thing for infrastructure systems like servers. They need the same IP address all the time.

Viewing Addressing Information with ifconfig 02:03-03:56
Now let's talk about configuring an IP address statically on a system such as a server. One way to do this is to use the ifconfig command at the shell prompt. If you type ifconfig without any options, all it does is display the current status of all the network interfaces in the system. Notice in the output that I have two network interfaces listed, ens32 and lo. ens32 is the Ethernet interface installed on my system that's connected to my network switch.

On the other hand, the lo interface isn't a real network interface. There's no physical interface in the system assigned the alias of lo because lo is a virtual network interface. It's the local loopback adapter. It's assigned a special IP address of 127.0.0.1. It's only used for internal communications between network services running on the system. It won't communicate on the network. This is required for most

Linux services to run properly, so don't do anything foolish like deleting it. You also don't need to worry about its configuration. Focus up here on the one that's connected to the physical network.

Notice in the output of ifconfig that several important network parameters are listed. First, we have the HWaddr parameter, which is the MAC address assigned to the network board. We have the inetaddr, which is the IP address assigned to the network interface. We also have the Bcast parameter, which specifies the broadcast address of the network segment. We have the Mask parameter, which specifies the subnet mask assigned to the interface.

Down here, we have RX packets, which specify statistics for the received packets on the interface. We also have TX packets, which contain statistics for transmitted packets from the interface. Collisions down here track the number of collisions detected by the interface, which on a modern Ethernet network should be zero—it is. We also have RX bytes, which tell us how many bytes have been received by the interface, and TX bytes, which tells us how many bytes have been transmitted by the interface.

Summary 03:56-04:13
Well, that's it for now. In this lesson, I gave you an overview of address configuration options and ifconfig. In another lesson, we'll learn how to use it to make a static IP address assignment and a dynamic IP address assignment.

## 12.2.3 Address Configuration Part 2

Click one of the buttons to take you to that part of the video.

Address Configuration 00:00-00:17
In a previous lesson, we discussed network interface parameters. We also discussed IP address assignment options and had an overview of the ifconfig command. With these basics in mind, let's discuss assigning the IP address and the subnet mask.

Configuring an Address with ifconfig 00:17-01:01
As previously discussed, you can use ifconfig to display information about a network interface. You can also use it to assign IP networking parameters.

The syntax for doing this is shown here. Type 'ifconfig', followed by the interface you want to make the assignment to, then the IP address that you want to assign, then 'netmask,' followed by the subnet mask you want to assign, then 'broadcast,' followed by the broadcast address of the network segment.

Here's an example. We're assigning the ens32 interface an IP address of 192.168.1.1, a subnet mask of 255.255.255.0, and a broadcast address of 192.168.1.255.

Interface Configuration File 01:01-03:17
If you make a static IP address assignment with the ifconfig command, that assignment is not persistent. If you remove the system, it'll be lost. To make it persistent, configure a special file in the /etc/sysconfig/network directory.

In this example, the file we'll use to configure a static IP address on an Ethernet interface is named ifcfg-ens32. This is the way it works on the openSUSE distribution. On other distributions, this file might be named differently. For example, it might be named using the MAC address of the NIC. You'll have to check how your distribution names the interface configuration file.

This file's used to configure IP addressing parameters on that interface when the system turns on. The first parameter you should know in this file is BOOTPROTO. Right now, it's set to 'dhcp,' which specifies that we dynamically assigned this interface and IP address from a DHCP server. You could change this to a value of 'static,' which would specify that the interface uses a static IP address assignment.

We also have a parameter down here called STARTMODE, and it's currently set to 'auto.' This option specifies that the interface will automatically be brought online when the system is booted. If you set it to a value of 'manual,' then you'd have to manually start the interface.

If we've specified BOOTPROTO='dhcp,' we don't have to do much else with this configuration file because that'll be taken care of by the DHCP Server. On the other hand, if we specified a static IP address assignment, we'd have to go through the rest of these options and configure the appropriate parameters.

For example, IPADDR. We'd have to specify the IP address we want to assign to this interface and the subnet mask under the NETMASK parameter. We'd also have to specify the network address of the network segment. We'd have to specify the broadcast address of the network segment as well.

There are some additional parameters you can modify if you need to, such as the MTU, where you can set the size of the maximum transmission unit. This is always set to 1500 by default on Ethernet networks. There are situations when you might need to change this. For example, if your network uses jumbo frames, you could set this parameter to something like 9000 instead of 1500. This isn't done very often, however.

Restarting a Network Interface 03:17-03:46
If you make any changes to this file, you must restart the network interface to apply the change. Otherwise, it won't be applied until the next time you boot the system. One simple way to do this is to use the ifdown command to take the interface down and then bring it back up with the ifup command.

An example's shown here. We enter 'ifdown ens32,' followed by 'ifup ens32.' At this point, the new configuration parameters we specified will be applied to that interface.

Getting an Address Dynamically 03:46-04:45
If you want your network interface to get an IP address from a DHCP server, you can do that from the command prompt, using the 'dhclient' command. If you've configured DHCP in your interface configuration file, you can accomplish the same thing using the ifdown and ifup commands. Because of your configuration in the interface configuration file, it will talk to DHCP.

If you want to tell a running interface to get an address from a DHCP Server, regardless of whether it's set to use a static address or dynamic address, you can run the dhclient command shown here. The syntax is to enter 'dhclient,' then the name of the interface that needs to contact a DHCP Server and get an IP address—in this case, 'ens32.' Notice when we do that, the interface first sends out a DHCPREQUEST packet and then it gets a DHCPACK back from the DHCP sever. The IP address of 10.0.0.97 was sent back from the DHCP server to the ens32 interface to be its IP address.

Viewing Address Information with ip 04:45-05:13
Another command you can use to manage IP addressing on a Linux system is the ip command. In this example, I'm using the ip command to view my current networking configuration. I type 'ip addr show,' and it shows me my configuration for my loopback interface and my ens32 interface. I can see many of the same statistics I saw with the ifconfig command, such as my MTU Size, my IP address and Mask, my Broadcast address, and so on.

Managing IP Addressing with ip 05:13-05:51
You can also use the ip command to configure IP addressing parameters. To do that, you use the syntax shown here. Enter 'ip addr add,' the IP address that we want to assign to the interface, �dev,' then the name of the interface.

If we want to remove an IP address, we replace add with �del,' which will remove the IP address from the specified interface. If we want to disable an interface, meaning take it down, we enter 'ip link set interface down.' To re-enable that interface, we do 'ip link set interface up.' That's the equivalent of using the ifdown and ifup commands.

Summary 05:51-06:20
That's it for this lesson. In this lesson, we talked about how to configure an Ethernet network interface in a Linux system. We talked about how to use ifconfig to make a static IP address assignment. We also talked about accomplishing the same thing using an interface configuration file. Then we looked at using dynamic addressing on an Ethernet interface and finally ended by reviewing how to use the ip command to manage IP addressing on a network interface.

## 12.2.4 View and Manage IPv4 Addresses

Click one of the buttons to take you to that part of the video.

View and Manage IPv4 Addresses 00:00-00:18
We're going to discuss different ways you can view and manage the network interface parameters from the shell prompt. We're going to focus on two different command-line tools in this demo: ifconfig and ip.

Use ifconfig 00:18-01:23
It's important to understand that the ifconfig command has been depreciated. Meaning it's being phased out and, in some cases, no longer available by default. However, if you find that the distribution you're working on doesn't have ifconfig, you can typically still get it by installing net-tools.

Ifconfig is short for interface config and can be run by any standard user to view the current networking configuration. As seen here, running ifconfig shows that this system has two interfaces: one named lo and the other named eth0. This may be confusing at first. If you only have one network card installed on the system, why would two interfaces show?

Every Linux system has a virtual interface. This is the lo, or loopback interface shown. It's mainly used by local services running on the system to send messages back and forth and can also be used for diagnostics and troubleshooting.

The other interface shown, eth0 is the Ethernet adapter installed on this system.

View Interface Statistics 01:23-02:14
The ifconfig output provides a lot of information regarding this interface. We can see that an IPv4 address of 192.168.78.10 has been assigned to this network card, with a netmask or subnet mask of 255.255.240.0 and a broadcast address of 192.168.79.255. If your system has Ipv6 enabled, you'll also see Ipv6 information.

This line shows the hardware or MAC address and lets us know that this is an Ethernet adapter. The last few lines show statistics about the IP packets that have been received and transmitted. RX indicates the packets that have been received, while TX gives us information about the packets that have been transmitted.

Configure IP Address Parameters 02:14-03:28
Modifying IP addresses can only be done using root privileges. To configure Ipv4 information manually, we use the ifconfig command and specify the parameters required.

The first parameter is the name of the network card you want to modify. It's possible to have several network interfaces installed on your system. Make sure you identify the network card you wish to make edits to. For this system, we type eth0.

Next, enter the new IP address 192.168.78.20. If that's the only change, we could press Enter now. However, to change the subnet mask, we'd type netmask, followed by the desired mask. We'll keep the same netmask and type 255.255.240.0.

Type broadcast for the broadcast address for this network segment. We'll also keep the same broadcast of 192.168.79.255. Press Enter. The order of the parameters used with ifconfig isn't critical, as long as you first specify which network card you're modifying. When we run ifconfig again, we see that the IP address was changed to .20.

Use if Commands 03:28-04:23
We can turn the interface off and on with ifdown and ifup. The ifdown command disables the network interface. When we type ifdown eth0 and press Enter, the network interface is brought down. When we run ifconfig, the only adapter shown is the loopback. To enable or start the adapter, type ifup eth0 and press Enter.

The Ethernet interface is now visible, but the IP address was changed back to its original address of .10. When a network adapter is initialized, the system looks at a configuration file. This file tells the system how to get its IP address information. If the system is configured for DHCP, it will have an IP address automatically assigned. This means that changing the IP address using ifconfig is a temporary change.

ip vs ifconfig 04:23-04:38
Let's shift gears and look at the preferred way to view and manage your network interface parameters with the IP tool. We'll see how to use ip to view and perform basic networking management, as we just did with ifconfig.

Use ip Command 04:38-05:13
Any standard user can use the ip command to view the current networking configuration. The ip command makes use of an option called an object. The man pages for the ip command show that this tool can be used for more than just IP addresses.

We see that an object is such things as a link and an address. Further down, we see a summary of the options, such as -h for human readable. A command is an action performed on the object, such as adding, deleting, or showing the object.

This was a brief overview of the ip command options.

View Network Configuration 05:13-05:45
We can't run ip by itself to view the networking configuration. We need to type ip and then the object, which is the address, and then the command to show this object or address.

We see much of the same information we saw when using ifconfig. Instead of showing the netmask in dotted decimal format, it's shown using the CIDR notation of /20. Instead of using the full ip [CC1]address show command, we can use ip a, which will show me the same information.

Add IP Addresses 05:45-06:30
We can use the ip command to temporarily change the IP information assigned to an interface. With ip, we want to add the correct IP information and then delete the incorrect information.

To add an IP address to your interface, type ip address add, followed by the new IP address. We'll use 192.168.78.15 followed by the subnet mask using the CIDR notation of /20. Next, we need to tell ip which interface to use, so we type dev for device and then the name of our device, which is eth0. When we run ip a again, we see two IP addresses assigned to the eth0 interface.

Delete IP Addresses 06:30-06:42
I can delete or remove the old IP address by typing ip address del 192.168.78.10. When we run ip a, we see the .10 address was deleted.

Change the ip Address State 06:42-07:27
With the ip command, changing the interface's status with the ip object named link will enable or disable the interface. To disable our eth0 interface, type ip link set, followed by the name of the interface, which is eth0, and then down.

This is a big difference between ifdown and ip's equivalent of ip link set down. When I run ip a again, we still see the eth0 interface. However, if you look closely, you'll see that the state of this interface is listed as being down, meaning that it's not listening or responding to network requests.

To bring this interface back online, we use the same command but change it from 'down' to 'up.'

Summary 07:27-07:38
In this demonstration, we looked at commands you can use from the shell prompt to manage IP addresses on your system.

## 12.2.5 Addressing Method Facts

There are two options for assigning IP addresses. You can use static addressing, or you can specify that IP addresses be dynamically assigned.

This lesson covers how to choose an IP assignment method.

### Choose an IP Assignment Method

The following table provides information to help you decide which method of assigning IP addresses you should choose.

<table>
<thead>
  <tr>
    <th>Method</th>
    <th>Uses</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td>Static (manual) assignment</td>
    <td>
      Using static addressing, IP configuration information must be
      manually configured on each host. Static addressing can be used:
      <ul>
        <li>On networks with a very small number of hosts.</li>
        <li>
          To permanently assign IP addresses to hosts that must always
          have the same address (such as printers, servers, or routers).
        </li>
        <li>For hosts that cannot accept an IP address from DHCP.</li>
      </ul>
      <div>
        <div class="to-info-box">
          <div class="to-info-box-body">
            <div class="to-icon large" aria-hidden="true" style="width: 20px;"><svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="circle-info" class="svg-inline--fa fa-circle-info" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 32a224 224 0 1 1 0 448 224 224 0 1 1 0-448zm0 480A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM208 352c-8.8 0-16 7.2-16 16s7.2 16 16 16l96 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0 0-112c0-8.8-7.2-16-16-16l-40 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l24 0 0 96-32 0zm48-168a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"></path></svg></div>
            <div class="to-info-box-body-content">
              <span>
                Static addressing is very susceptible to configuration
                errors and duplicate IP address configuration errors (two
                hosts that have been assigned the same IP address). Static
                addressing also disables both APIPA and DHCP capabilities
                on the host.</span
              >
            </div>
          </div>
        </div>
      </div>
    </td>
  </tr>
  <tr>
    <td>Dynamic Host Configuration Protocol (DHCP) assignment</td>
    <td>
      A DHCP server is a special server configured to pass out IP
      addresses and other IP configuration information to network clients.
      Use DHCP for small, medium, or large networks.
      <ul>
        <li>
          When a client boots, it contacts the DHCP server for IP
          configuration information.
        </li>
        <li>
          The DHCP server is configured with a range of IP addresses that
          it can assign to hosts.
        </li>
        <li>
          The DHCP server can be configured to pass out other IP
          configuration, such as the default gateway and DNS server
          addresses.
        </li>
        <li>
          The DHCP server ensures that each client has a unique IP
          address.
        </li>
        <li>
          The DHCP server can be configured to not assign specific
          addresses in the range.
        </li>
        <li>
          The DHCP server assigns the IP address and other information to
          the client. The assignment is called a lease and includes a
          lease time that identifies how long the client can use the IP
          address.
        </li>
        <li>
          At boot and at set intervals, the client contacts the DHCP
          server to renew the lease on the IP address.
        </li>
        <li>
          The DHCP lease process uses frame-level broadcasts. For this
          reason, DHCP requests typically do not pass through routers to
          other subnets. To enable DHCP across subnets:
          <ul>
            <li>
              Enable BootP (DHCP broadcast) requests through the router.
            </li>
            <li>
              Configure a computer for BootP forwarding to request IP
              information on behalf of other clients.
            </li>
          </ul>
        </li>
        <li>
          A DHCP server can be configured to deliver the same address to a
          specific host each time it requests an address. This is called a
          reservation.
        </li>
      </ul>
    </td>
  </tr>
</tbody>
</table>

## 12.2.6 Network Configuration Facts

Linux uses files and commands for network configuration.

This lesson covers the following topics:

- Network configuration files
- Network configuration commands

### Network Configuration Files

The following table identifies files that Linux uses for network configuration:

<table>
<thead>
  <tr>
    <th>File or Directory</th>
    <th>Description</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td><b>/etc/sysconfig/network-scripts</b></td>
    <td>
      This directory contains network configuration files. For example,
      each network interface in the system is configured using a
      configuration file in this directory named
      <b>ifcfg- <i>device_name</i></b>
      (for example, <b>ifcfg-ens192</b> ). Edit the appropriate device
      file in this directory to modify the following settings:
      <ul>
        <li>Boot protocol (static, DHCP, or BootP)</li>
        <li>Autoconfiguration information</li>
        <li>
          IP address, mask, and default router (for static configurations)
        </li>
      </ul>
    </td>
  </tr>
  <tr>
    <td>
      <b>/var/lib/dhcpcd/dhcpclient
        <i>n <br /></i>
        /var/lib/dhcpcd/dhclient.leases
        <br />
        /var/lib/dhclient/dhclient.leases</b>
    </td>
    <td>
      These files contain DHCP lease information. The specific file used
      will vary between distributions.
    </td>
  </tr>
  <tr>
    <td><b>/etc/netplan</b></td>
    <td>
      This directory contains the *.yaml file that defines the network
      configuration parameters, such as:
      <ul>
        <li>On/off toggle for DHCP4 and DHCP6</li>
        <li>Static IP address</li>
        <li>Gateway IP address</li>
        <li>IP addresses of nameservers</li>
      </ul>
      <h2>sudo netplan try</h2>
    </td>
  </tr>
  <tr>
    <td><b>/etc/dhcp/dhclient.conf</b></td>
    <td>
      This configuration file defines dhclient parameters, such as:
      <ul>
        <li>Protocol timing</li>
        <li>Information requested from the server</li>
        <li>Information required from the server</li>
        <li>
          Preinitialized addresses for networks without DHCP servers
        </li>
      </ul>
    </td>
  </tr>
</tbody>
</table>

### Network Configuration Commands

The table below shows common commands for configuring network settings:

<table>
<thead>
  <tr>
    <th>Command</th>
    <th>Function</th>
    <th>Example</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td>
      <b>/etc/init.d/network<br />/etc/rc.d/init.d/network<br />service network</b>
    </td>
    <td>
      Starts, restarts, or stops networking services on init-based
      distributions.
    </td>
    <td>
      <b>service network start</b> starts the network service.
      <b><br />service network restart</b>
      restarts the network service.
    </td>
  </tr>
  <tr>
    <td>
      <b>systemctl <i>command</i> network</b>
    </td>
    <td>Manages network services on systemd-based distributions.</td>
    <td>
      <b>systemctl stop network</b> stops the networking service.
      <b><br />systemctl start network</b>
      starts the networking service.
      <b><br />systemctl restart network</b>
      restarts the networking service.
    </td>
  </tr>
  <tr>
    <td>
      <b>ifconfig<br />ifconfig <i>interface</i></b>
    </td>
    <td>
      Views network interface information. Use the <b>-a</b> option to
      display the status of all interfaces.
    </td>
    <td>
      <b>ifconfig -a</b> displays the status of all interfaces, even those
      that are down.
    </td>
  </tr>
  <tr>
    <td>
      <b>ifconfig</b> <b><i>interface parameters</i></b>
    </td>
    <td>
      Creates a static IP configuration for the specified interface.
      Common <b>ifconfig</b> parameters include the following:
      <ul>
        <li><b>address</b> - sets the IP address</li>
        <li><b>netmask</b> - sets the subnet mask</li>
        <li><b>broadcast</b> - sets the broadcast address</li>
        <li><b>up</b> - activates the interface</li>
        <li><b>down</b> - deactivates the interface</li>
      </ul>
    </td>
    <td>
      <b>ifconfig ens192 192.168.1.1 netmask addr 255.255.255.0</b>
      configures a static IP address and subnet mask for the ens192
      interface. <br />
      <b>ifconfig ens192 up</b> starts the ens192 interface.
    </td>
  </tr>
  <tr>
    <td><b>ifup</b> <b> interface</b></td>
    <td>Starts a network interface.</td>
    <td><b>ifup ens192</b> starts the ens192 network device.</td>
  </tr>
  <tr>
    <td><b>ifdown</b> <b> interface</b></td>
    <td>Stops a network interface.</td>
    <td><b>ifdown ens192</b> stops the ens192 network device.</td>
  </tr>
  <tr>
    <td>
      <b>ip addr show <i>interface</i></b>
    </td>
    <td>
      Displays the current networking information for a network interface.
      Omitting the interface from the command displays networking
      information for all interfaces in the system. Common
      <b>ip addr show</b> parameters include the following:
      <ul>
        <li>
          <b>inet</b> - shows the IPv4 address with the subnet mask in
          CIDR notation.
        </li>
        <li><b>brd</b> - shows the broadcast address.</li>
        <li><b>up</b> or <b>down</b> - shows the interface status.</li>
        <li><b>inet6</b> - shows the IPv6 IP address.</li>
      </ul>
    </td>
    <td>
      <b>ip addr show ens192</b> displays networking information for the
      ens192 interface.
    </td>
  </tr>
  <tr>
    <td>
      <b>ip addr add <i>ip_address</i> dev <i>interface</i></b>
    </td>
    <td>Adds an additional IP address to a network interface.</td>
    <td>
      <b>ip addr add 10.0.0.3 dev ens32</b> adds an IP address of 10.0.0.3
      to the ens32 network interface.
    </td>
  </tr>
  <tr>
    <td>
      <b>ip addr del <i>ip_address</i> dev <i>interface</i></b>
    </td>
    <td>Removes an IP address from a network interface.</td>
    <td>
      <b>ip addr del 10.0.0.3 dev ens32</b> removes an IP address of
      10.0.0.3 from the ens32 network interface.
    </td>
  </tr>
  <tr>
    <td>
      <b>ip link set <i>interface</i> down<br />ip link set <i>interface</i> up</b>
    </td>
    <td>Stops and starts the specified interface.</td>
    <td>
      <b>ip link set ens32 down</b> stops the ens32 interface.
      <b><br />ip link set ens32 up</b>
      starts the ens32 interface.
    </td>
  </tr>
  <tr>
    <td><b>ethtool</b></td>
    <td>
      Lists and changes Ethernet card properties such as supported modes,
      auto-negotiation, speed, wake on, duplex, link detection status, and
      port. You can also use it to list and change driver settings.
    </td>
    <td>
      <b>ethtool <i>devname</i></b> queries Ethernet device properties.
      <br />
      <b>ethtool <i>-</i> i <i>devname</i></b> queries Ethernet device
      driver and firmware. <br />
      <b>ethtool <i>-</i> C <i>drivername</i> adaptive-rx on</b> adjusts
      the moderation time to the traffic pattern.
    </td>
  </tr>
  <tr>
    <td><b>iwconfig</b></td>
    <td>
      Displays and changes the parameters of the wireless network
      interfaces.
    </td>
    <td>
      <b>iwconfig <i>wirelessname</i></b> <b>freq 2.46G</b> sets the
      frequency to 2.46 G. <br />
      <b>iwconfig <i>wirelessname</i> mode Managed</b> activates roaming
      and allows connection to any one of a number of access points on the
      network.
    </td>
  </tr>
  <tr>
    <td><b>brctl</b></td>
    <td>
      Sets up, maintains, and inspects the Ethernet bridge configuration
      in the Linux kernel.
    </td>
    <td>
      <b>brctl show</b> shows all current instances of the Ethernet
      bridge. <br />
      <b>brctl show <i>bridgename</i></b> shows information about the
      bridge and its attached ports. <br />
      <b>brctl showmacs</b> <b><i>bridgename</i></b> shows a list of
      learned MAC addresses for this bridge.
    </td>
  </tr>
</tbody>
</table>

## 12.2.7 Network Interface Bonding Facts

A Bonding Bandwidth On Demand Interoperability Group, referred to as bonding or aggregation, combines multiple network interfaces into a single bonding interface. A bonding interface allows you to increase throughput by increasing bandwidth and traffic load sharing. It provides high availability through redundant network connections, link integrity monitoring, and failover.

This lesson covers the following topics:

<ul><li>Aggregation overview</li>
   <li>Installation</li>
   <li>Bonding configuration</li>
<li>Slave configuration</li></ul>

### Aggregation Overview

Aggregation (bonding) combines a group of ports into a link aggregation group, or LAG. A Linux bonding driver aggregates two or more network interface controllers into a single logical bonded interface. The LAG (bonding) is referred to as the master; the network interfaces associated with the bond are referred to as slaves. The Link Aggregation Control Protocol (LACP) is used to include or remove individual links from the LAG. Be aware that:

<ul><li>A scheduling algorithm defines which packets are sent along which link.</li>
<li>IEEE standard for link aggregation is 802.1AX.</li>
<li>All links must be identical (Ethernet 10/100/1000/10G, etc.).</li>
<li>All links must be configured the same way (duplex settings, VLAN configurations, and queuing features).</li>
<li>There is a maximum of eight individual links in a LAG group.</li>
<li>An even number of links usually provides better load balancing.</li>
<li>Bonding interfaces function according to whether the modes are hot standby or load balancing.</li>
<li>Bonded devices are directly connected to a dedicated switch device, or another system, such as a computer running Linux.</li></ul>

### Installation

Most kernels ship with the bonding driver already available as a module and the ifenslave program installed. If your distribution does not or you need to compile bonding from source, be aware that:

<ul><li>The current version of the bonding driver is available in the drivers/net/bonding subdirectory of the most recent kernel source.</li>
<li>You can add bonding to the kernel with modprobe.</li>
<li>When you configure the driver as a module, you will be able to pass parameters to the driver or configure more than one bonding device.</li>
<li>After you build and install the new kernels and modules, install the ifenslave control utility. ifenslave should correspond to the kernel you are using.</li>
<li>Options for the bonding driver are supplied as parameters to the bonding module at load time, usually specified in either the /etc/modules.conf or /etc/modprobe.conf configuration file.</li></ul>

### Bonding Configuration

#### insmod

<div class="to-info-box-body">
<div class="to-icon large" aria-hidden="true" style="width: 20px;"><svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="circle-info" class="svg-inline--fa fa-circle-info" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 32a224 224 0 1 1 0 448 224 224 0 1 1 0-448zm0 480A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM208 352c-8.8 0-16 7.2-16 16s7.2 16 16 16l96 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0 0-112c0-8.8-7.2-16-16-16l-40 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l24 0 0 96-32 0zm48-168a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"></path></svg></div>
<div class="to-info-box-body-content">
<span>
When bonding using active/passive, the term passive is also known as the slave.</span>
</div>
</div>

The following table identifies parameters you can include.

<table>
<thead>
<tr>
  <th>Parameters</th>
  <th>Description</th>
  <th>Example</th>
</tr>
</thead>
<tbody>
<tr>
  <td><b>DEVICE</b></td>
  <td>Specifies a number to identify the bond.</td>
  <td><b>DEVICE=bond1</b> identifies the bond as bond1.</td>
</tr>
<tr>
  <td><b>TYPE</b></td>
  <td>Specifies driver type.</td>
  <td><b>TYPE=Ethernet</b> indicates an Ethernet connection.</td>
</tr>
<tr>
  <td><b>STARTMODE</b></td>
  <td>
    Specifies when the driver will be started. The options are
    <b>onboot</b> and <b>manual</b> .
    <ul>
      <li>
        <b>onboot</b> activates the bond when the system is started.
      </li>
      <li><b>manual</b> requires the boot to be started.</li>
    </ul>
  </td>
  <td><b>STARTMODE=ONBOOT</b> activates the bond at startup.</td>
</tr>
<tr>
  <td><b>USERCTL</b></td>
  <td>
    Allows or prohibist system users from making changes to the bond.
  </td>
  <td><b>USERCTL=no</b> allows only root to make changes.</td>
</tr>
<tr>
  <td><b>NM_CONTROLLED</b></td>
  <td>
    Indicates whether the bond will be controlled by NetworkManager.
  </td>
  <td>
    <b>NM_CONTROLLED=n</b> o specifies NetworkManager is not used to
    manage the bond.
  </td>
</tr>
<tr>
  <td><b>MTU</b></td>
  <td>Specifies the maximum transmission unit (MTU).</td>
  <td><b>MTU=9000</b></td>
</tr>
<tr>
  <td><b>BOOTPROTO</b></td>
  <td>
    Determines the protocol type to initialize the device. There are
    three options:
    <ul>
      <li>
        <b>dhcp</b> causes the system to search for the DHCP server.
      </li>
      <li>
        <b>bootp</b> indicates the boot protocol looks for a DHCP
        server.
      </li>
      <li>
        <b>static</b> or <b>none</b> indicates DHCP will not be used.
      </li>
    </ul>
  </td>
  <td>
    <b>BOOTPROTO=static</b> indicates DHCP will not be used. <br />
    <b>BOOTPROTO=dhcp</b> indicates that DHCP will be used.
  </td>
</tr>
<tr>
  <td><b>IPADDR</b></td>
  <td>Specifies the IP address for the bond.</td>
  <td>
    <b>IPADDR=179.254.0.2</b> uses 179.254.0.2 as the IP address for the
    bond.
  </td>
</tr>
<tr>
  <td><b>BONDING_OPTS</b></td>
  <td>
    Bonding options include the following:
    <ul>
      <li>
        <b>arp_interval</b> specifies the ARP link monitoring frequency
        in milliseconds.
      </li>
      <li>
        <b>downdelay</b> specifies the time, in milliseconds, to wait
        before disabling a slave after a link failure has been detected.
        This option is valid only for the miimon link monitor. The
        downdelay value should be a multiple of the miimon value or it
        will be rounded down to the nearest multiple. The default value
        is 0.
      </li>
      <li>
        <b>lacp_rate</b> specifies the rate to transmit LACPDU (LACP
        data unit) packets in 802.3ad mode. Slow, or 0, transmits
        LACPDUs every 30 seconds. Fast, or 1, transmits LACPDUs every
        second. Slow is the default setting.
      </li>
      <li>
        <b>maxbonds</b> specifies the number of bonding devices to
        create for this instance of the bonding driver.
      </li>
      <li>
        <b>miimon</b> specifies the MII link monitoring frequency in
        milliseconds. This determines how often the link state of each
        slave is inspected for link failures. A value of zero disables
        MII link monitoring.
      </li>
      <li>
        <b>mode</b> specifies if the links function as either hot
        standby or load balancing services. The behavior of the single
        logical bonded interface is specified by the bonding driver
        mode. The default parameter is balance-rr. Modes can be
        specified by numbers as follows:
        <ul>
          <li>
            <b>mode=0</b> Balance Round Robin (balance-rr): this mode
            transmits network packets in sequential order from the first
            available network interface (NIC) slave through the last.
            This mode provides load balancing and fault tolerance.
          </li>
          <li>
            <b>mode=1</b> Active backup: only one NIC slave in the bond
            is active. A different slave becomes active if the active
            slave fails. This mode provides fault tolerance.
          </li>
          <li>
            <b>mode=2</b> Balance XOR: this mode transmits network
            packets based on a hash of the packet's source and
            destination. The same NIC slave is used for each destination
            MAC address, IP address, or IP address and port combination.
            This mode provides load balancing and fault tolerance.
          </li>
          <li>
            <b>mode=3</b> Broadcast: this mode transmits network packets
            on all slave network interfaces. This mode provides fault
            tolerance.
          </li>
          <li>
            <b>mode=4</b> 802.3ad Dynamic link aggregation: each
            aggregation group shares the same speed and duplex settings.
            This mode is similar to the XOR mode and supports the same
            balancing policies. The link is set up dynamically between
            two LACP-supporting peers.
          </li>
          <li>
            <b>mode=5</b> Adaptive transmit load balancing
            (balance-tlb): This mode does not require any special
            network switch support. The outgoing network packet traffic
            is distributed according to the current load on each network
            interface slave.
          </li>
          <li>
            <b>mode=6</b> Adaptive load balancing (balance-alb): this
            mode includes balance-tlb plus receive load balancing (rlb)
            for IPV4 traffic. It does not require any special network
            switch support. The receive load balancing is achieved by
            ARP negotiation.
          </li>
        </ul>
      </li>
      <li>
        <b>primary</b> specifies which slave is the primary device. The
        primary device will always be the active slave while it is
        available. Only when the primary is offline will another device
        be used.
      </li>
      <li>
        <b>updelay</b> specifies the time, in milliseconds, to wait
        before enabling a slave after a link recovery has been detected.
        The updelay value should be a multiple of the miimon value.
      </li>
    </ul>
  </td>
  <td>
    Use
    <b>BONDING_OPTS=("mode=0 miimon=100 downdelay=400("</b>
    to use rr for load balancing, activate link monitoring every 100
    milliseconds, and wait 500 milliseconds before disabling a failed
    link.
    <br />
    <br />
    <b>Use BONDING_OPTS=("mode=1 primary=eth0 LACPDU=1 maxbonds=8("</b>
    to specify active backup, eth0 as the primary slave, a maximum of 8
    bonds, and transmit LACPDU packets each second.
  </td>
</tr>
<tr>
  <td><b>SLAVE</b></td>
  <td>Identifies the slave interfaces for the bonding.</td>
  <td>
    <b>BONDING_SLAVE0=eth0</b> indicates the interface name. eth0 is a
    slave in the bond. <br />
    <b>BONDING_SLAVE1=bus-pci-0000:06:08.1</b> indicates that the
    interface name bus-pci-0000:06:08.1 is a slave in the bond.
  </td>
</tr>
</tbody>
</table>

Follow these guidelines when configuring a bonding:

<ul><li>Configure the LAG on both sides of the link.</li>
<li>Set the interfaces on both sides of the link to the same speed.</li>
<li>Configure and apply firewall filters on a LAG (optional).</li>
<li>Use IP addresses in the load balancing algorithm for better performance when all communication is between two devices, such as a router and a firewall.</li></ul>

### Slave Configuration

#### `ifcfg-xxxn`

<table>
<thead>
<tr>
  <th>Parameter</th>
  <th>Description</th>
  <th>Example</th>
</tr>
</thead>
<tbody>
<tr>
  <td><b>DEVICE</b></td>
  <td>Specifies a name to identify the interface.</td>
  <td>
    <b>DEVICE=eth0</b> identifies the first Ethernet interface created.
  </td>
</tr>
<tr>
  <td><b>USERCTL</b></td>
  <td>
    Allows or prohibit system users from making changes to the
    interface.
  </td>
  <td><b>USERCTL=no</b> allows only root to make changes.</td>
</tr>
<tr>
  <td><b>ONBOOT</b></td>
  <td>Specifies whether the interface will be started at boot.</td>
  <td>
    <b>ONBOOT=yes</b> starts the interface when the system is booted.
  </td>
</tr>
<tr>
  <td><b>MASTER</b></td>
  <td>Identifies the master associated with the slave interface.</td>
  <td>
    <b>MASTER=bond0</b> indicates the master for the slave is bond0.
  </td>
</tr>
<tr>
  <td><b>SLAVE</b></td>
  <td>Specifies that the interface is a slave.</td>
  <td><b>SLAVE=yes</b> indicates the interface is a slave.</td>
</tr>
<tr>
  <td><b>BOOTPROTO</b></td>
  <td>
    Determines the protocol type to initialize the device. The protocol
    must be the same of the protocol specified for the master. There are
    three options:
    <ul>
      <li>
        <b>dhcp</b> causes the system to search for the DHCP server.
      </li>
      <li>
        <b>bootp</b> indicates the boot protocol looks for a DHCP
        server.
      </li>
      <li>
        <b>static</b> or <b>none</b> indicates DHCP will not be used.
      </li>
    </ul>
  </td>
  <td>
    <b>BOOTPROTO=static</b> indicates DHCP will not be used <br />
    <b>BOOTPROTO=dhcp</b> indicates that DHCP will be used.
  </td>
</tr>
</tbody>
</table>
